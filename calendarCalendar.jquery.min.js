!function(t,e){function a(e,a){this.element=e,this.options=t.extend(!0,{},o,a),this._defaults=o,this._name=s,this.init()}var n=new Date,i=new Date,s="calendarCalendar",o={containerName:"calendarCalendar",lexicon:{titleDays:["Su","Mo","Tu","We","Th","Fr","Sa"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],startCalendarTitle:"Arrive On",endCalendarTitle:"Depart On"},startCalendarTitle:"Arrive On",endCalendarTitle:"Depart On",startDateId:"calendar-start-date",endDateId:"calendar-end-date",startDate:n,endDate:new Date(i.setDate(n.getDate()+1)),minDate:null,maxDate:null,onDateChange:function(){},calculatePosition:function(t){return this.calculatePosition(t)},showPaddingDates:!1,calendarMode:"range",showBackground:!0,showCloseButton:!1,closeButtonContent:"x"};a.prototype={init:function(){this.open=!1,this.container=t("#"+this.options.containerName),0==this.container.length&&(this.container=t("<div>",{id:this.options.containerName}),t("body").append(this.container),this.container=t("#"+this.options.containerName)),this.container.hide(),t(this.element).unbind("click",t.proxy(this.drawCalendars,this)).bind("click",t.proxy(this.drawCalendars,this)),this.options.calendarMode="single"==this.options.calendarMode||"range"==this.options.calendarMode?this.options.calendarMode:"range",this.options.startDateId==this.options.endDateId&&(this.options.endDateId+="2"),this.options.maxDate<this.options.minDate&&(this.options.maxDate=null,this.options.maxDate=null),this.dateUpdate(this),null!=this.options.startDate&&this.options.startDate.setHours(0,0,0,0),null!=this.options.endDate&&this.options.endDate.setHours(0,0,0,0),null!=this.options.minDate&&this.options.minDate.setHours(0,0,0,0),null!=this.options.maxDate&&this.options.maxDate.setHours(0,0,0,0),t(e).unbind("resize",t.proxy(this.resize,this)).bind("resize",t.proxy(this.resize,this))},closeCalendar:function(){return this.open=!1,this.container.hide(),this.container.html(""),"closed"},resize:function(){return this.open&&this.drawCalendars(),"resized"},drawCalendars:function(){this.open=!0,this.container.css("opacity",0),this.container.show();var e="";this.options.showBackground&&(e=t("<div>",{"class":"background"}),e.bind("click",t.proxy(this.closeCalendar,this)));var a="";this.options.showCloseButton&&(a=t("<div>",{"class":"close-button"}).html(this.options.closeButtonContent),a.bind("click",t.proxy(this.closeCalendar,this)));var n=this.generateCalendar(this.options.startDate,this.options.startDateId,this.options.lexicon.startCalendarTitle),i="range"==this.options.calendarMode?this.generateCalendar(this.options.endDate,this.options.endDateId,this.options.lexicon.endCalendarTitle):"",s=t("<div>",{"class":"calendars "+this.options.calendarMode}).html(n).append(i).append(a);this.container.html(e).append(s);try{s.css(t.proxy(this.options.calculatePosition,this,t(this.element))())}catch(o){console.log("custom calculatePosition returned dud positioning - using the default positioning"),s.css(t.proxy(this.calculatePosition,this,t(this.element))())}this.container.css("opacity",1)},calculatePosition:function(t){var e=t.offset(),a={top:e.top+t.outerHeight(),left:e.left+t.outerWidth()};return a},generateCalendar:function(e,a,n){var i="calendar";this.options.maxDate instanceof Date&&+e.getMonth()==+this.options.maxDate.getMonth()&&+e.getFullYear()==+this.options.maxDate.getFullYear()&&(i+=" max-month"),this.options.minDate instanceof Date&&+e.getMonth()==+this.options.minDate.getMonth()&&+e.getFullYear()==+this.options.minDate.getFullYear()&&(i+=" min-month");var s=t("<div>",{id:a,"class":i}),o=t("<div>",{"class":"calendar-header"}),d=t("<div>",{"class":"calendar-arrow left"}),r=t("<div>",{"class":"calendar-title"}),l=t("<div>",{"class":"calendar-caption"}).html(n),h=t("<div>",{"class":"calendar-date"}).html(this.options.lexicon.longMonths[e.getMonth()]+" "+e.getFullYear()),p=t("<div>",{"class":"calendar-arrow right"}),c=t("<div>",{"class":"caldendar-main"}),D=t("<div>",{"class":"calendar-days calendar-table"}),u=t("<div>",{"class":"calendar-dates calendar-table"});d.bind("click",{date:e,month:e.getMonth()-1},t.proxy(this.monthClickEvent,this)),p.bind("click",{date:e,month:e.getMonth()+1},t.proxy(this.monthClickEvent,this)),o.append(d),r.append(l),r.append(h),o.append(r),o.append(p),s.append(o);for(var g=0;7>g;g++)D.append(t("<div>",{"class":"calendar-cell"}).html(this.options.lexicon.titleDays[g]));for(var m=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),v=new Date(e.getFullYear(),e.getMonth(),1).getDay(),g=v;g>0;g--){var f;if(this.options.showPaddingDates){var x=new Date(e.getFullYear(),e.getMonth(),1);x.setDate(x.getDate()-g),f=x.getDate()}else f="&nbsp;";u.append(t("<div>",{"class":"calendar-cell disabled padding"}).html(f))}var y=new Date;y.setHours(0,0,0,0);for(var g=1;m>=g;g++){var w=new Date(e.valueOf());w.setDate(g),w.setHours(0,0,0,0);var C="calendar-cell";C+=a==this.options.endDateId&&w<=this.options.startDate||w<this.options.minDate&&this.options.minDate instanceof Date||w>this.options.maxDate&&this.options.maxDate instanceof Date||a==this.options.startDateId&&+w==+this.options.maxDate&&"range"==this.options.calendarMode?" disabled":" active",g==e.getDate()&&(C+=" selected"),w.getTime()==y.getTime()&&(C+=" today");var M=t("<div>",{"class":C}).html(g);-1==C.indexOf("disabled")&&M.bind("click",{date:e,day:g},t.proxy(this.dayClickEvent,this)),u.append(M)}for(var g=1;42-(v+m)>=g;g++){var f;if(this.options.showPaddingDates){var x=new Date(e.getFullYear(),e.getMonth(),m);x.setDate(x.getDate()+g),f=x.getDate()}else f="&nbsp;";u.append(t("<div>",{"class":"calendar-cell disabled padding"}).html(f))}return c.append(D),c.append(u),s.append(c),s},dayClickEvent:function(t){t.data.date.setDate(t.data.day),this.dateUpdate(),"range"==this.options.calendarMode?this.drawCalendars():this.closeCalendar()},monthClickEvent:function(t){t.data.date.setMonth(t.data.month),this.dateUpdate(),this.drawCalendars()},dateUpdate:function(){this.options.minDate instanceof Date&&+this.options.minDate>+this.options.startDate&&(this.options.startDate=new Date(this.options.minDate.valueOf())),this.options.maxDate instanceof Date&&+this.options.maxDate<=+this.options.startDate&&(this.options.startDate=new Date(this.options.maxDate.valueOf()),"range"==this.options.calendarMode&&this.options.startDate.setDate(this.options.startDate.getDate()-1)),this.options.maxDate instanceof Date&&+this.options.maxDate<+this.options.endDate&&(this.options.endDate=new Date(this.options.maxDate.valueOf())),+this.options.endDate<=+this.options.startDate&&(this.options.endDate=new Date(this.options.startDate.valueOf()),this.options.endDate.setDate(this.options.endDate.getDate()+1)),this.options.onDateChange(this.options.startDate,this.options.endDate,this.options.lexicon)}},t.fn[s]=function(e){return this.each(function(){if(t.data(this,"plugin_"+s)){var n=t.data(this,"plugin_"+s);n.options=t.extend(!0,{},n.options,e),n.init()}else{var n=new a(this,e);t.data(this,"plugin_"+s,n)}})}}(jQuery,window,document);
