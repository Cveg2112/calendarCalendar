!function(t,e,a,n){function s(e,a){this.element=e,this.options=t.extend(!0,{},r,a),this._defaults=r,this._name=d,this.init()}var i=new Date,o=new Date,d="calendarCalendar",r={containerName:"calendarCalendar",lexicon:{titleDays:["Su","Mo","Tu","We","Th","Fr","Sa"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],startCalendarTitle:"Arrive On",endCalendarTitle:"Depart On",singleCalendarTitle:""},startDateId:"calendar-start-date",endDateId:"calendar-end-date",startDate:i,endDate:new Date(o.setDate(i.getDate()+1)),minDate:null,maxDate:null,onDateChange:function(){},calculatePosition:function(t){return this.calculatePosition(t)},onOpen:function(){},onClose:function(){},showPaddingDates:!1,calendarMode:"range",showBackground:!0,showCloseButton:!1,closeButtonContent:"x",closeOnDateSelect:!1,initializeDateChange:!0};s.prototype={init:function(){this.open=!1,this.container=t("#"+this.options.containerName),0==this.container.length&&(this.container=t("<div>",{id:this.options.containerName,class:"calendarCalendar"}),t("body").append(this.container),this.container=t("#"+this.options.containerName)),this.container.removeClass("open"),t(this.element).unbind("click",t.proxy(this.drawCalendars,this)).bind("click",t.proxy(this.drawCalendars,this)),this.options.calendarMode="single"==this.options.calendarMode||"range"==this.options.calendarMode?this.options.calendarMode:"range",this.options.startDateId==this.options.endDateId&&(this.options.endDateId+="2"),this.options.maxDate<this.options.minDate&&(this.options.maxDate=null,this.options.maxDate=null),this.dateUpdate(this.options.initializeDateChange),null!=this.options.startDate&&this.options.startDate.setHours(0,0,0,0),null!=this.options.endDate&&this.options.endDate.setHours(0,0,0,0),null!=this.options.minDate&&this.options.minDate.setHours(0,0,0,0),null!=this.options.maxDate&&this.options.maxDate.setHours(0,0,0,0),t(e).unbind("resize",t.proxy(this.resize,this)).bind("resize",t.proxy(this.resize,this));var n=this;t(a).on("focus","*",function(e){var s=a.getElementById(n.options.containerName);n.open&&!t.contains(s,e.target)&&s!=e.target?(e.stopPropagation(),n.container.find("*[tabIndex]").first().focus()):console.log(e.target)})},closeCalendar:function(t){if("keypress"!=t.type||13==t.keyCode)return this.open=!1,this.container.removeClass("open"),this.container.attr("tabindex","-2"),"range"==this.options.calendarMode?this.options.onClose(this.options.startDate,this.options.endDate,this.options.lexicon,this.element):this.options.onClose(this.options.startDate,this.options.lexicon,this.element),"closed"},resize:function(){return this.open&&this.drawCalendars(),"resized"},drawCalendars:function(){var e=1;this.open||("range"==this.options.calendarMode?this.options.onOpen(this.options.startDate,this.options.endDate,this.options.lexicon,this.element):this.options.onOpen(this.options.startDate,this.options.lexicon,this.element)),this.open=!0,this.container.addClass("open");var a="";this.options.showBackground&&(a=t("<div>",{class:"background",tabIndex:e++})).bind("click keypress",t.proxy(this.closeCalendar,this));var n="";if(this.options.showCloseButton&&(n=t("<div>",{class:"close-button",tabIndex:e++}).html(this.options.closeButtonContent)).bind("click keypress",t.proxy(this.closeCalendar,this)),"range"==this.options.calendarMode)var s=this.generateCalendar(this.options.startDate,this.options.startDateId,this.options.lexicon.startCalendarTitle,e),i=this.generateCalendar(this.options.endDate,this.options.endDateId,this.options.lexicon.endCalendarTitle,s.find("*[tabIndex]").length);else var s=this.generateCalendar(this.options.startDate,this.options.startDateId,this.options.lexicon.singleCalendarTitle,0),i="";var o=t("<div>",{class:"calendars "+this.options.calendarMode}).html(s).append(i).append(n);if(this.container.html(a).append(o),null!=this.options.calculatePosition)try{o.css(t.proxy(this.options.calculatePosition,this,t(this.element))())}catch(e){console.log("custom calculatePosition returned dud positioning - using the default positioning"),o.css(t.proxy(this.calculatePosition,this,t(this.element))())}this.container.attr("tabindex","0"),this.container.focus()},calculatePosition:function(t){var e=t.offset();return{top:e.top+t.outerHeight(),left:e.left+t.outerWidth()}},generateCalendar:function(e,a,n,s){s=void 0!==s?s:0;var i="calendar";this.options.maxDate instanceof Date&&+e.getMonth()==+this.options.maxDate.getMonth()&&+e.getFullYear()==+this.options.maxDate.getFullYear()&&(i+=" max-month"),this.options.minDate instanceof Date&&+e.getMonth()==+this.options.minDate.getMonth()&&+e.getFullYear()==+this.options.minDate.getFullYear()&&(i+=" min-month");var o=t("<div>",{id:a,class:i}),d=t("<div>",{class:"calendar-header"}),r=t("<a>",{class:"calendar-arrow left"});i.indexOf("min-month")&&r.attr("tabIndex",s++);var l=t("<div>",{class:"calendar-title"}),h=t("<div>",{class:"calendar-caption"}).html(n),p=t("<div>",{class:"calendar-date"}).html(this.options.lexicon.longMonths[e.getMonth()]+" "+e.getFullYear()),c=t("<a>",{class:"calendar-arrow right"});i.indexOf("max-month")&&c.attr("tabIndex",s++);var D=t("<div>",{class:"caldendar-main"}),u=t("<div>",{class:"calendar-days calendar-table"}),g=t("<div>",{class:"calendar-dates calendar-table"});r.bind("click keypress",{date:e,month:e.getMonth()-1},t.proxy(this.monthClickEvent,this)),c.bind("click keypress",{date:e,month:e.getMonth()+1},t.proxy(this.monthClickEvent,this)),d.append(r),l.append(h),l.append(p),d.append(l),d.append(c),o.append(d);for(f=0;f<7;f++)u.append(t("<div>",{class:"calendar-cell"}).html(this.options.lexicon.titleDays[f]));for(var m=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),x=new Date(e.getFullYear(),e.getMonth(),1).getDay(),f=x;f>0;f--){this.options.showPaddingDates?((w=new Date(e.getFullYear(),e.getMonth(),1)).setDate(w.getDate()-f),M=w.getDate()):M="&nbsp;",g.append(t("<div>",{class:"calendar-cell disabled padding"}).html(M))}var v=new Date;v.setHours(0,0,0,0);for(f=1;f<=m;f++){var y=new Date(e.valueOf());y.setDate(f),y.setHours(0,0,0,0);var C="calendar-cell";a==this.options.endDateId&&y<=this.options.startDate||y<this.options.minDate&&this.options.minDate instanceof Date||y>this.options.maxDate&&this.options.maxDate instanceof Date||a==this.options.startDateId&&+y==+this.options.maxDate&&"range"==this.options.calendarMode?C+=" disabled":C+=" active",f==e.getDate()&&(C+=" selected"),y.getTime()==v.getTime()&&(C+=" today");var b=t("<a>",{class:C}).html(f);-1==C.indexOf("disabled")&&(b.bind("click keypress",{date:e,day:f,id:a},t.proxy(this.dayClickEvent,this)),b.attr("tabIndex",s++)),g.append(b)}for(f=1;f<=42-(x+m);f++){var M;if(this.options.showPaddingDates){var w=new Date(e.getFullYear(),e.getMonth(),m);w.setDate(w.getDate()+f),M=w.getDate()}else M="&nbsp;";g.append(t("<div>",{class:"calendar-cell disabled padding"}).html(M))}return D.append(u),D.append(g),o.append(D),o},dayClickEvent:function(t){"keypress"==t.type&&13!=t.keyCode||(t.data.date.setDate(t.data.day),this.dateUpdate(),this.options.closeOnDateSelect?"range"==this.options.calendarMode&&t.data.id!=this.options.endDateId?this.drawCalendars():this.closeCalendar():this.drawCalendars())},monthClickEvent:function(t){"keypress"==t.type&&13!=t.keyCode||(t.data.date.setMonth(t.data.month),this.dateUpdate(),this.drawCalendars())},dateUpdate:function(t){t=void 0===t||t,this.options.minDate instanceof Date&&+this.options.minDate>+this.options.startDate&&(this.options.startDate=new Date(this.options.minDate.valueOf())),this.options.maxDate instanceof Date&&+this.options.maxDate<=+this.options.startDate&&(this.options.startDate=new Date(this.options.maxDate.valueOf()),"range"==this.options.calendarMode&&this.options.startDate.setDate(this.options.startDate.getDate()-1)),this.options.maxDate instanceof Date&&+this.options.maxDate<+this.options.endDate&&(this.options.endDate=new Date(this.options.maxDate.valueOf())),+this.options.endDate<=+this.options.startDate&&(this.options.endDate=new Date(this.options.startDate.valueOf()),this.options.endDate.setDate(this.options.endDate.getDate()+1)),t&&("range"==this.options.calendarMode?this.options.onDateChange(this.options.startDate,this.options.endDate,this.options.lexicon):this.options.onDateChange(this.options.startDate,this.options.lexicon))}},t.fn[d]=function(e){return this.each(function(){if(t.data(this,"plugin_"+d))(a=t.data(this,"plugin_"+d)).options=t.extend(!0,{},a.options,e),a.init();else{var a=new s(this,e);t.data(this,"plugin_"+d,a)}})}}(jQuery,window,document);