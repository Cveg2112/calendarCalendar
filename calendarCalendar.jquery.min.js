(function(e,t,n,r){function a(t,n){this.element=t;this.options=e.extend({},u,n);this._defaults=u;this._name=o;this.init()}var i=new Date,s=new Date,o="calendarCalendar",u={containerName:"calendarCalendar",titleDays:["Su","Mo","Tu","We","Th","Fr","Sa"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],startCalendarTitle:"Arrive On",endCalendarTitle:"Depart On",startDateId:"calendar-start-date",endDateId:"calendar-end-date",startDate:i,endDate:new Date(s.setDate(i.getDate()+1)),minDate:null,maxDate:null,onDateChange:function(e,t,n,r,i,s){},calculatePosition:function(e){return this.calculatePosition(e)},showPaddingDates:false,calendarMode:"range"};a.prototype={init:function(){this.open=false;this.container=e("#"+this.options.containerName);if(this.container.length==0){this.container=e("<div>",{id:this.options.containerName});e("body").append(this.container);this.container=e("#"+this.options.containerName)}this.container.hide();e(this.element).bind("click",e.proxy(this.drawCalendars,this));this.options.calendarMode=this.options.calendarMode=="single"||this.options.calendarMode=="range"?this.options.calendarMode:"range";if(this.options.startDateId==this.options.endDateId)this.options.endDateId+="2";if(this.options.maxDate<this.options.minDate){this.options.maxDate=null;this.options.maxDate=null}this.dateUpdate(this);if(this.options.startDate!=null){this.options.startDate.setHours(0,0,0,0)}if(this.options.endDate!=null){this.options.endDate.setHours(0,0,0,0)}if(this.options.minDate!=null){this.options.minDate.setHours(0,0,0,0)}if(this.options.maxDate!=null){this.options.maxDate.setHours(0,0,0,0)}e(t).bind("resize",e.proxy(this.resize,this))},closeCalendar:function(){this.open=false;this.container.hide();this.container.html("")},resize:function(){if(this.open){this.drawCalendars()}},drawCalendars:function(){this.open=true;this.container.show();var t=e("<div>",{"class":"background"});t.bind("click",e.proxy(this.closeCalendar,this));var n=this.generateCalendar(this.options.startDate,this.options.startDateId,this.options.startCalendarTitle);var r=this.options.calendarMode=="range"?this.generateCalendar(this.options.endDate,this.options.endDateId,this.options.endCalendarTitle):"";var i=e("<div>",{"class":"calendars "+this.options.calendarMode}).html(n).append(r);i.offset(e.proxy(this.options.calculatePosition,this,e(this.element)));this.container.html(t).append(i)},calculatePosition:function(e){var t=e.offset();return{top:t.top+e.outerHeight(),left:t.left+e.outerWidth()}},generateCalendar:function(t,n,r){var i="calendar";if(this.options.maxDate instanceof Date&&+t.getMonth()==+this.options.maxDate.getMonth()&&+t.getFullYear()==+this.options.maxDate.getFullYear())i+=" max-month";if(this.options.minDate instanceof Date&&+t.getMonth()==+this.options.minDate.getMonth()&&+t.getFullYear()==+this.options.minDate.getFullYear())i+=" min-month";var s=e("<div>",{id:n,"class":i});var o=e("<div>",{"class":"calendar-header"});var u=e("<div>",{"class":"calendar-arrow left"});var a=e("<div>",{"class":"calendar-title"});var f=e("<div>",{"class":"calendar-caption"}).html(r);var l=e("<div>",{"class":"calendar-date"}).html(this.options.longMonths[t.getMonth()]+" "+t.getFullYear());var c=e("<div>",{"class":"calendar-arrow right"});var h=e("<div>",{"class":"caldendar-main"});var p=e("<div>",{"class":"calendar-days calendar-table"});var d=e("<div>",{"class":"calendar-dates calendar-table"});u.bind("click",{date:t,month:t.getMonth()-1},e.proxy(this.monthClickEvent,this));c.bind("click",{date:t,month:t.getMonth()+1},e.proxy(this.monthClickEvent,this));o.append(u);a.append(f);a.append(l);o.append(a);o.append(c);s.append(o);for(var v=0;v<7;v++){p.append(e("<div>",{"class":"calendar-cell"}).html(this.options.titleDays[v]))}var m=(new Date(t.getFullYear(),t.getMonth()+1,0)).getDate();var g=(new Date(t.getFullYear(),t.getMonth(),1)).getDay();for(var v=g;v>0;v--){var y;if(this.options.showPaddingDates){var b=new Date(t.getFullYear(),t.getMonth(),1);b.setDate(b.getDate()-v);y=b.getDate()}else{y="&nbsp;"}d.append(e("<div>",{"class":"calendar-cell disabled padding"}).html(y))}for(var v=1;v<=m;v++){var w=new Date(t.valueOf());w.setDate(v);var E="calendar-cell";if(n==this.options.endDateId&&w<=this.options.startDate||w<this.options.minDate&&this.options.minDate instanceof Date||w>this.options.maxDate&&this.options.maxDate instanceof Date||n==this.options.startDateId&&+w==+this.options.maxDate&&this.options.calendarMode=="range")E+=" disabled";else E+=" active";if(v==t.getDate())E+=" selected";var S=e("<div>",{"class":E}).html(v);if(E.indexOf("disabled")==-1)S.bind("click",{date:t,day:v},e.proxy(this.dayClickEvent,this));d.append(S)}for(var v=1;v<=42-(g+m);v++){var y;if(this.options.showPaddingDates){var b=new Date(t.getFullYear(),t.getMonth(),m);b.setDate(b.getDate()+v);y=b.getDate()}else{y="&nbsp;"}d.append(e("<div>",{"class":"calendar-cell disabled padding"}).html(y))}h.append(p);h.append(d);s.append(h);return s},dayClickEvent:function(e){e.data.date.setDate(e.data.day);this.dateUpdate();if(this.options.calendarMode=="range")this.drawCalendars();else this.closeCalendar()},monthClickEvent:function(e){e.data.date.setMonth(e.data.month);this.dateUpdate();this.drawCalendars()},dateUpdate:function(){if(this.options.minDate instanceof Date&&+this.options.minDate>+this.options.startDate){this.options.startDate=new Date(this.options.minDate.valueOf())}if(this.options.maxDate instanceof Date&&+this.options.maxDate<=+this.options.startDate){this.options.startDate=new Date(this.options.maxDate.valueOf());if(this.options.calendarMode=="range")this.options.startDate.setDate(this.options.startDate.getDate()-1)}if(this.options.maxDate instanceof Date&&+this.options.maxDate<+this.options.endDate){this.options.endDate=new Date(this.options.maxDate.valueOf())}if(+this.options.endDate<=+this.options.startDate){this.options.endDate=new Date(this.options.startDate.valueOf());this.options.endDate.setDate(this.options.endDate.getDate()+1)}this.options.onDateChange(this.options.startDate,this.options.endDate,this.options.shortDays,this.options.longDays,this.options.shortMonths,this.options.longMonths)}};e.fn[o]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+o)){var n=new a(this,t);e.data(this,"plugin_"+o,n)}})}})(jQuery,window,document)